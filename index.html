<!DOCTYPE html>
<!-- TASK: Add the class 'h-full' to the html element. -->
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- TASK: Create a title element with the content of "Long Test - Midterm" -->
  <title>Long Test - Midterm</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<!-- TASK: Add the class 'h-full' to the body element. -->
<body class="h-full">
  <!-- TASK: Make a div with the class of 'h-full', 'w-full', 'bg-gray-900', 'grid', and 'grid-cols-12' -->
  <div class="h-full w-full bg-gray-900 grid grid-cols-12">
    <!-- TASK: Make another div inside that div you just made. And give it the class 'col-span-8', 'bg-blue-600', 'shadow-md', 'm-4', and 'rounded-md' -->
    <div class="col-span-8 bg-blue-600 shadow-md m-4 rounded-md">
      <!-- TASK: Inside the div you just made. Make an Heading 1 element with the class 'text-2xl', 'font-bold', 'text-white', 'text-center', and 'p-4'. Give it also an ID of 'current-month-element' -->
      <h1 class="text-2xl font-bold text-white text-center p-4" id="current-month-element"></h1>
      <!-- TASK: Below the h1 element you just made. Make another div give it these classes: 'bg-blue-800', 'py-4', 'grid', 'grid-cols-7', 'text-center', 'font-bold', and 'text-white' -->
      <div class="bg-blue-800 py-4 grid grid-cols-7 text-center font-bold text-white">
        <!-- TASK: Inside that div just made make 7 divs. The content of all these divs should be SUN, MON, ..., SAT. In THAT SPECIFIC ORDER -->
        <div>SUN</div>
        <div>MON</div>
        <div>TUE</div>
        <div>WED</div>
        <div>THU</div>
        <div>FRI</div>
        <div>SAT</div>
      </div>
      <!-- TASK: Make another div. Give this an id of 'days' and a classes of: 'grid', 'grid-cols-7' -->
      <div id="days" class="grid grid-cols-7"></div>
    </div>
    <!-- TASK: Create a div, give this the class of: 'relative', 'col-span-4', 'bg-blue-900', 'rounded-tl-lg', 'rounded-bl-lg' -->
    <div class="relative col-span-4 bg-blue-900 rounded-tl-lg rounded-bl-lg">
      <!-- TASK: Create an Heading 1 element with the classes: 'text-2xl', 'text-white', 'text-center', 'py-4', 'font-bold'. The content of this element should be: "Events" -->
      <h1 class="text-2xl text-white text-center py-4 font-bold">Events</h1>
      <!-- TASK: Create a div with the class of 'flex', 'flex-col'. Give this an id of 'events-list' -->
      <div class="flex flex-col" id="events-list">
        <!-- TASK: Create a div with the class of 'flex', 'flex-col', 'bg-blue-600', 'p-2'.-->
        <div class="flex flex-col bg-blue-600 p-2">
          <!-- TASK: Create an Heading 1 element with the classes: 'py-2', 'text-center', 'font-bold', 'text-xl', 'text-white'. Give this the content of: Add Event Form-->
          <h1 class="py-2 text-center font-bold text-xl text-white">Add Event Form</h1>
          <!-- TASK: Create an input element with type of text. Give it an id of 'event_name' and a placeholder value of 'Event Name'. The class should be: p-2 border-none outline-none m-2 rounded-md -->
          <input type="text" id="event_name" placeholder="Event Name" class="p-2 border-none outline-none m-2 rounded-md">
          <!-- TASK: Create an input element with type of text. Give it an id of 'event_description' and a placeholder value of 'Description'. The class should be: p-2 border-none outline-none m-2 rounded-md -->
          <input type="text" id="event_description" placeholder="Description" class="p-2 border-none outline-none m-2 rounded-md">
          <!-- TASK: Create an input element with type of date. Give it an id of 'event_date'. The class should be: p-2 border-none outline-none m-2 rounded-md -->
          <input type="date" id="event_date" class="p-2 border-none outline-none m-2 rounded-md">
          <!-- TASK: Create an input element with type of time. Give it an id of 'event_time'. The class should be: p-2 border-none outline-none m-2 rounded-md -->
          <input type="time" id="event_time" class="p-2 border-none outline-none m-2 rounded-md">
          <!-- TASK: Create a button element with an onclick attribute set to makeEvent() the class should be 'w-full', 'bg-blue-400', 'py-4', 'font-bold', 'mt-8', 'hover:bg-blue-500', 'text-white'. The text of this button should be: Make Event -->
          <button onclick="makeEvent()" class="w-full bg-blue-400 py-4 font-bold mt-8 hover:bg-blue-500 text-white">Make Event</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // TASK: Create a variable named `dateNow` and assign it to the following value: new Date();
    let dateNow = new Date();
    // TASK: Create a variable named `selectedDay` and assign it to an empty string.
    let selectedDay = "";
    // TASK: Create a variable named `events` and assign it to an empty object.
    let events = {};
    // TASK: Create a variable named `months` and assign it all of the month names from January to December in-order.
    let months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

    let currentMonth = dateNow.getMonth();
    let currentDate = dateNow.getDate();
    let currentDayOfWeek = dateNow.getDay();
    let currentYear = dateNow.getFullYear();
    let firstDayOfWeek = new Date(currentYear, currentMonth).getDay();
    let lastDayOfMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

    function uuidv4() {
      return "10000000-1000-4000-8000-100000000000".replace(/[018]/g, c =>
        (+c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> +c / 4).toString(16)
      );
    }

    // TASK: Create a function named deleteEvent this function should have two parameters: day and eventId.
    
    function deleteEvent(day, eventId) {
      // TASK: Call the `showEvents` function and pass in the argument the variable day.
      showEvents(day);
      // TASK: Call the `render` function.
      render();
    }

    // TASK: Create a function named `showEvents`. This function should take in a singular parameter named `day`.
    function showEvents(day) {
      // TASK: Create a variable named `eventsDayList` and assign it the value: events[day]
      let eventsDayList = events[day];
      // TASK: Assign the variable `selectedDay` to the variable `day`
      let selectedDay = day;

      if(typeof eventsDayList === 'undefined') {
        // TASK: Assign the `eventsDayList` to an empty array.
        let eventsDayList=[];
      }

      // TASK: Target the element with the ID of `events-list` and set it's innerHTML property to an empty string.
      document.getElementById('events-list').innerHTML = "";

      for(let event of eventsDayList) {
        document.getElementById('events-list').innerHTML += `<div class="bg-blue-500 p-4 text-white flex items-center justify-between">
          <div>
            <h1 class="text-xl font-bold">${event.name}</h1>
            <p class="font-light">${event.description}</p>
          </div>
          <div>
            <button onclick="deleteEvent(${day}, ${event.id})">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 hover:stroke-red-200">
                <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
              </svg>              
            </button>
          </div>
        </div>`
      }
    }

    // TASK: Create a function named `makeEvent`
    function makeEvent() {
      let eventObject = {
        id: uuidv4(),
        name: document.getElementById('event_name').value,
        description: document.getElementById('event_description').value,
        date: document.getElementById('event_date').value,
        time: document.getElementById('event_time').value,
      }
      
      if(!events[new Date(eventObject.date).getDate()]) {
        events[new Date(eventObject.date).getDate()] = [];
      }
      
      events[new Date(eventObject.date).getDate()].push(eventObject);
      // TASK: Call the `render` function.
      render();
    }

    // TASK: Create a function named `render`.
    function render() {
      // TASK: Target the element with the id of 'days' and assign it's innerHTML property to an empty string.
      document.getElementById('days').innerHTML = "";

      // TASK: Make a for loop that loops from 0 up to the firstDayOfWeek (this is a variable).
      for(let i = 0; i < firstDayOfWeek; i++) {
        // TASK: Target the element with the id of 'days' and CONCATENATE/APPEND to its innerHTML property the value: `<div></div>`;
        document.getElementById('days').innerHTML += `<div></div>`;
      }

      for(let i = 1; i <= lastDayOfMonth; i++) {
        // TASK: Create a variable named `eventCount` and set it to an empty string.
        let eventCount = "";
        if(events[i]) {
          eventCount = events[i].length;
        }

        if(i === currentDate) {
          document.getElementById('days').innerHTML += `<div onclick="showEvents(${i})" class="font-bold m-1 rounded-md relative border-4 flex justify-center items-center h-32"><span class="bg-yellow-400 rounded-full h-6 text-center w-6 absolute top-2 right-2">${i}</span><p>${eventCount}</p></div>`;
          continue;
        }

        document.getElementById('days').innerHTML += `<div onclick="showEvents(${i})" class="font-bold m-1 rounded-md relative border-4 flex justify-center items-center h-32"><span class="absolute top-2 right-2">${i}</span><p>${eventCount}</p></div>`;
      }
    }

    // TASK: call the `render` function.
    render();
    document.getElementById('current-month-element').innerHTML = months[currentMonth];
  </script>
</body>
</html>